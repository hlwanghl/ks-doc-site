---
title: "部署"
---

部署（ Deployment ）为 Pod 和 ReplicaSet 提供了一个声明式定义 ( declarative ) 方法来管理应用。典型的应用场景包括定义 Deployment 来创建 Pod 和 ReplicaSet、滚动升级和回滚应用、扩容和缩容以及暂停和继续 Deployment。


本节通过以下几个方面介绍如何管理部署：

- 创建部署
- 查看部署详情
- 编辑部署
- 删除部署

## 创建部署

首先登录 KubeSphere 控制台，访问左侧菜单栏，在 **应用负载** 菜单下，点击 **部署** 按钮，进入部署列表页面。选择不同的项目，就可以看到对应项目下的所有部署。如果是管理员登录，可以看到集群所有项目的部署情况，如果是普通用户，则只能查看授权项目下的所有部署。

![部署列表](/deployment_list.png)

1. 点击右上角 **创建部署** 按钮，新建一个部署。

![创建部署 - 基础信息](/deployment_create_1.png)

目前创建部署一共有三种方式，**页面创建**，**导入 yaml 文件** 创建，**代码模式** 创建。其中导入 yaml 文件方式会自动将 yaml 文件内容填充到页面上，用户根据需要可以在页面上调整后再行创建。代码模式可以方便习惯命令行操作的人员直接在页面上编辑 yaml 文件并创建部署。

![创建部署 - 代码模式](/deployment_create_2.png)

这里重点介绍页面创建的方式。需要输入部署的名称并选择创建部署的项目，确定部署的副本数量，用户还可以根据需求填写部署的描述信息。

![创建部署 - 页面模式](/deployment_create_3.png)

2. 在 **容器组设置** 页面, 用户可以根据需求对容器组进行配置。容器组可以包含一个或者多个容器。要求输入容器的名称和对应的镜像名。如果用户有更进一步的需求，可以点击**高级选项**。高级选项中可以对 CPU 和内存的资源使用进行限定。其中 **requests** 是集群保证分配给容器的资源，**limits** 是容器可以使用的资源的上限。超过这个限定值，容器会被 kill。用户可以通过**命令**和**参数** 选项自定义容器的启动命令和启动参数。**端口** 用于指定容器需要暴露的端口，端口协议可以选择 TCP 和 UDP, 用户还可以指定端口与主机端口进行绑定。**环境变量** 可以指定容器内部使用的环境变量。上述配置信息填写完成以后，点击下一步。

![创建部署 - 容器组设置](/deployment_create_4.png)

3. 在存储卷页面可以添加 **存储卷** 和 **临时存储卷**。存储卷可用于持久化用户数据；保留在临时存储卷中的数据，在容器组被删除以后，也将被同步删除。 选择使用临时存储卷方案时要求用户输入存储卷的名称和相应的挂载点，然后点击 **挂载** 和 **确定**。

![创建部署 - 临时存储](/deployment_create_5.png)

当选择使用存储卷时，可以选择 **已有存储卷** 或者根据需求 **新建存储卷**。当选择新建存储卷时，用户需要填写存储卷的名称，选择存储类型，指定容量和访问模式。最后输入挂载点，并且点击挂载和确定，点击下一步。

![创建部署 - 存储](/deployment_create_6.png)

4. 标签设置页用于指定部署对应的一组或者多组标签。

![创建部署 - 标签](/deployment_create_7.png)

5. 节点选择器页面，用户可以通过指定一组或者多组键值对来指定期望运行容器组的主机。当不指定时，容器组将有可能调度到集群内满足调度条件的任意节点。最后点击创建，集群就会按照用户的配置创建对应的部署。

![创建部署 - 节点选择器](/deployment_create_8.png)
 

## 查看部署详情 

* 在部署列表页，点击某个部署的名称，就可以进入到部署详情页，可以查看部署的详细信息以及部署对应的各种资源。

![查看部署](/deployment_read_1.png)

* 同时在本页可以通过左下角的容器组数量栏调整部署的副本数量，左上角的更多选项编辑配置文件，暂停/开启/删除部署。

![查看部署详情页](/deployment_read_4.png)

* 当点击容器组列表的容器时，页面会跳转到容器组的详情页。

![查看容器组](/deployment_read_2.png)

* 点击容器组详情页的容器列表中的某一容器时，会跳转到容器的详情页，可以看到容器的配置信息，对应资源以及日志。在本页，用户还可以通过左上角的 **终端** 按钮进入容器内部。

![查看容器](/deployment_read_3.png)


## 编辑部署

* 在部署的列表页和详情页中都可以编辑部署对应的 yaml 文件，编辑是在代码模式下完成的，编辑完成以后，点击右下方的更新按钮，部署就会按照最新的配置进行更新。

![更新部署](/deployment_update_1.png)

* 如果只是修改部署的描述信息，可以使用部署详情页左上角的 **编辑** 进行修改。

![编辑部署描述信息](/deployment_update_2.png)

## 删除部署

* 在列表页最右侧的更多选项和部署详情页的左上方的更多选项中都提供了部署的删除功能。

 ![删除部署1](/deployment_delete_1.png)

 ![删除部署2](/deployment_delete_2.png)
